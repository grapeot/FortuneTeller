# 微软春节庙会AI算命方案

## 项目背景

### 基本信息
- **场合**：微软春节联欢会 - 庙会
- **身份**：赞助商（AI Course Developer，AI课程开发商）
- **时间**：明天（需快速部署）
- **地点**：庙会现场（流动人群，热闹喜庆）
- **受众**：微软员工（程序员为主）

### 核心需求
1. **强交互性**：观众能够深度参与，不只是看
2. **低门槛**：快速上手，不需长时间等待
3. **节日氛围**：结合春节元素，喜庆热闹
4. **品牌关联**：可结合AI Course Developer定位
5. **高能级**：适合庙会流动人群，快速参与
6. **多模态**：展示摄像头+视觉AI能力

---

## 产品需求文档（PRD）

### 产品概述
**产品名称**：AI算命师
**产品定位**：基于人脸分析的趣味AI算命游戏
**核心价值**：用微软黑话娱乐，展示AI多模态能力

### 目标用户
- **主要用户**：微软工程师、PM、产品经理
- **用户特点**：熟悉微软文化，对职级体系敏感，幽默感强
- **使用场景**：庙会现场，快速体验，多人围观

### 核心功能

#### 1. 待机模式
```
- 显示摄像头实时画面
- 实时人脸检测框
- 提示文字："AI算命师等您一卦"
- 背景音乐：轻快春节音乐
```

#### 2. 隐私授权
```
- 检测到人脸后弹出询问：
  "AI算命需要分析您的人脸信息，是否同意？"
- 两个按钮：
  [同意] [不同意]
- 不同意：返回待机模式
- 同意：进入算命模式
```

#### 3. AI算命
```
步骤1：人脸分析（2秒）
- 显示"正在分析您的面相..."
- 显示分析进度条
- 显示模拟分析数据（职级、气质、运势等）

步骤2：算命结果（3秒）
- 使用微软黑话进行趣味解读
- 随机生成算命文案（基于预设模板）
- 显示"算命结果"大标题

步骤3：祝福语（2秒）
- 春节祝福
- 品牌植入
```

### 算命文案设计

#### 职级相关文案
```
- "看您这面相，骨相清奇，必是L63以上的Senior！"
- "眉宇间透着Principal的气质，L65起步！"
- "眼神坚毅，一看就是资深SDE，技术大牛！"
- "面容沉稳，PM本色，产品思维拉满！"
- "气质像刚从L59升级到L60，潜力股！"
- "这气质，Partner级别的人物啊！"
```

#### 职位相关文案
```
- "看您的眼神，透着SDE的严谨和智慧！"
- "气场强大，一看就是Manager级别！"
- "这面相，PM无疑了，产品感爆棚！"
- "SDET气质拉满，质量就是生命！"
- "IC路线走得稳，技术大牛！"
```

#### 运势相关文案
```
- "龙年大吉，Bug全消，代码质量UP！"
- "春节快乐，Review秒过，合并顺利！"
- "新年好运，项目上线，性能完美！"
- "新春大吉，技术突破，薪资暴涨！"
- "过年好，AI在手，天下我有！"
```

#### 混合文案（推荐）
```
- "看您这面相，骨相清奇，必是L63以上的Senior！龙年大吉，Bug全消，代码质量UP！"
- "眉宇间透着Principal的气质，L65起步！新年好运，项目上线，性能完美！"
- "眼神坚毅，一看就是资深SDE，技术大牛！新春大吉，技术突破，薪资暴涨！"
- "面容沉稳，PM本色，产品思维拉满！春节快乐，Review秒过，合并顺利！"
- "这气质，Partner级别的人物啊！龙年大吉，Bug全消，AI在手，天下我有！"
```

### 面相学基础与文案方向

#### 传统面相学要素（用于文案创作参考）
面相学主要观察以下部位，可以结合这些元素创作更有"专业感"的算命文案：

**五官观察点：**
- **额头（天庭）**：宽广饱满 → 智慧、领导力 → 可对应Principal、Manager
- **眉毛**：浓密整齐 → 逻辑思维强 → 可对应SDE、技术专家
- **眼睛**：明亮有神 → 洞察力强 → 可对应PM、产品思维
- **鼻子**：高挺 → 决策力强 → 可对应Manager、Leader
- **嘴巴**：嘴角上扬 → 沟通能力强 → 可对应PM、跨团队协作
- **下巴（地阁）**：方正 → 执行力强 → 可对应IC、实干型

**气质类型（可随机组合）：**
- **技术型**：眼神专注、眉宇间透着代码的严谨
- **管理型**：气场强大、额头宽广、有领导风范
- **产品型**：眼神灵动、善于观察、洞察力强
- **潜力型**：面相年轻、但眼神坚定、未来可期

#### 文案创作方向（Brainstorm）

**方向1：职级进阶路线**
- 从面相看职业发展路径（IC路线 vs Manager路线）
- 预测职级晋升时间（"面相显示，今年Q3有望升L62"）
- 分析适合的职级区间（"这面相，L60-L63之间最合适"）

**方向2：技术栈匹配**
- 从面相看适合的技术方向（"眼神深邃，适合做AI/ML"）
- 预测技术突破领域（"眉宇间透着创新，今年在LLM领域有突破"）
- 分析代码风格（"面相显示，写代码风格优雅，Review必过"）

**方向3：工作运势**
- 项目运势（"面相显示，Q1项目顺利上线"）
- 团队协作（"这面相，跨团队合作无压力"）
- 技术债务（"面相显示，今年能还清技术债"）

**方向4：微软文化梗**
- OneDrive同步（"面相显示，文件同步从不冲突"）
- Teams会议（"这面相，Teams会议从不掉线"）
- Azure部署（"面相显示，Azure部署一次成功"）
- Windows更新（"这面相，Windows更新从不蓝屏"）

**方向5：程序员专属梗**
- Bug修复（"面相显示，Bug见您就自动修复"）
- Code Review（"这面相，PR Review秒过，无Comments"）
- 性能优化（"面相显示，代码性能自动提升30%"）
- 技术债务（"这面相，技术债见您就还清"）

**方向6：春节+职场结合**
- 龙年运势（"龙年面相，技术突破，薪资翻倍"）
- 春节祝福+职场预测（"龙年大吉，Q1升职，Q2加薪"）
- 新年目标（"面相显示，新年目标：L63达成"）

**方向7：幽默反转**
- 反套路（"面相显示，您今天会写Bug，但能快速修复"）
- 自嘲式（"这面相，一看就是写Bug的高手"）
- 反差萌（"面相显示，外表严肃，代码风格却很萌"）

**方向8：多维度组合**
- 职级 + 技术栈 + 运势（"L63 Senior，AI/ML专家，龙年技术突破"）
- 职位 + 性格 + 预测（"PM面相，产品思维强，Q2产品上线"）
- 气质 + 能力 + 祝福（"技术大牛气质，代码质量高，新年Bug全消"）

#### 文案模板结构建议

**三段式结构（推荐）：**
1. **面相观察**（1-2句）：描述面部特征，建立"专业感"
2. **职业解读**（1-2句）：结合微软文化，给出职业判断
3. **运势祝福**（1-2句）：春节祝福 + 职场预测

**示例模板：**
```
[面相观察] + [职业解读] + [运势祝福]

"看您这[部位]，[特征描述]，必是[职级/职位]！[微软黑话]！[春节祝福]！"
```

**四段式结构（进阶）：**
1. **面相观察**
2. **职业解读**
3. **技术预测**
4. **春节祝福**

#### 文案库扩展建议

**按职级分类：**
- L59-L61（初级）："面相年轻，潜力股，今年有望升L60"
- L62-L64（中级）："面相成熟，技术扎实，L63稳了"
- L65+（高级）："面相不凡，Principal气质，技术大牛"

**按职位分类：**
- SDE：代码、技术、架构相关
- PM：产品、用户、需求相关
- Manager：团队、领导、协作相关
- SDET：质量、测试、稳定性相关

**按运势分类：**
- 技术运势：代码质量、技术突破、架构优化
- 项目运势：项目上线、性能提升、用户增长
- 职场运势：升职、加薪、跳槽、转岗
- 生活运势：工作生活平衡、健康、家庭

### 现场互动与气氛调动

#### 主持人话术方向

**开场吸引（待机模式）：**
- "来来来，AI算命师免费算一卦！看看您今年能不能升L63！"
- "微软黑话算命，看看您是SDE还是PM！"
- "龙年运势预测，AI算命师等您来测！"
- "程序员专属算命，看看您的代码运势！"

**引导参与（检测到人脸）：**
- "有朋友过来了！AI算命师已经看到您了，要不要算一卦？"
- "摄像头已经检测到您，点击同意，让AI看看您的面相！"
- "来来来，站近一点，让AI算命师看清楚您的面相！"

**分析过程（分析中）：**
- "AI正在分析您的面相...看看您是L几的！"
- "正在扫描...检测到技术大牛气质！"
- "分析中...看看您今年能不能升职！"

**结果展示（算命结果）：**
- "哇！AI算命师说您是L65的Principal！"
- "看看看！AI说您今年Q1项目上线！"
- "不得了！AI预测您今年技术突破，薪资暴涨！"
- "AI算命师说您是PM面相，产品思维拉满！"

**互动引导（结果后）：**
- "怎么样？准不准？要不要再算一次？"
- "看看旁边同事的面相，对比一下！"
- "拍照发朋友圈，看看AI怎么说！"
- "扫码领AI课程优惠券，学AI，算得更准！"

#### 气氛调动策略

**1. 制造悬念**
- 分析过程中显示"正在检测职级..."，增加期待感
- 结果展示前有短暂停顿，制造悬念
- 可以显示"检测到特殊面相..."增加趣味

**2. 鼓励围观**
- 大屏幕显示，吸引路过的人围观
- 结果展示时，可以鼓励围观人群一起看
- 可以设计"围观模式"，多人一起看结果

**3. 互动游戏**
- 可以设计"猜职级"游戏：围观人群先猜，再看AI结果
- 可以设计"对比模式"：两个人一起算，对比结果
- 可以设计"挑战模式"：看看AI能不能猜对真实职级

**4. 拍照分享**
- 结果展示时，鼓励拍照分享
- 可以设计"算命证书"样式，方便分享
- 可以添加二维码，扫码查看详细结果

**5. 幽默互动**
- 如果AI说错了，主持人可以幽默化解："AI也有Bug的时候！"
- 可以设计"AI算命师也会出错"的梗
- 可以鼓励用户"纠正"AI，增加互动

**6. 品牌植入**
- 结果展示后，自然引导到AI课程
- "AI算命师建议：学AI，算得更准！"
- "扫码领AI课程优惠券，提升AI技能！"

#### 现场应急预案

**如果用户不愿意授权：**
- 主持人："没关系，AI算命师尊重您的选择！"
- 可以准备"手动算命"模式：主持人根据观察给出幽默解读

**如果算命结果不够准确：**
- 主持人："AI也有Bug的时候，但娱乐第一！"
- 可以设计"AI算命师也会出错"的幽默梗

**如果现场冷场：**
- 主持人主动示范，自己先算一卦
- 可以邀请工作人员先算，吸引围观
- 可以设计"AI算命师自测"模式，展示AI能力

**如果技术故障：**
- 准备备用方案：手动算命模式
- 可以准备"AI算命师离线版"：预设文案随机展示
- 可以准备"AI算命师Demo版"：展示预设结果

#### 现场氛围营造

**视觉元素：**
- 大屏幕显示，吸引眼球
- 春节元素（灯笼、祥云、龙）增加节日氛围
- AI算命师形象（可选卡通形象）增加趣味性

**音效设计：**
- 待机模式：轻快春节音乐
- 检测到人脸：提示音效
- 分析过程：神秘音效
- 结果展示：欢快音效
- 祝福语：喜庆音效

**互动节奏：**
- 快速体验：每个用户2-3分钟完成
- 结果展示：3-5秒，然后自动返回待机
- 鼓励连续体验：可以设计"连续算命"模式

#### 传播策略

**现场传播：**
- 鼓励拍照分享朋友圈
- 可以设计"算命证书"样式，方便分享
- 可以添加二维码，扫码查看详细结果

**后续传播：**
- 可以录制"AI算命师Demo视频"
- 可以制作"AI算命师精彩瞬间"合集
- 可以设计"AI算命师挑战"：看看AI能不能猜对真实职级

### 视觉设计

#### 主界面
```
- 深色背景（科技感）
- 春节元素（龙年、灯笼、祥云）
- AI算命师形象（可选卡通形象）
- 大屏幕友好（考虑围观人群）
```

#### 算命结果页面
```
- 大标题"您的算命结果"
- 算命文案（大字体，清晰可见）
- 背景动画（烟花、祥云等）
- 声音提示（欢快音效）
```

### 用户流程

```
用户走近大屏幕
    ↓
摄像头检测到人脸
    ↓
弹出隐私授权窗口
    ↓
用户点击"同意"
    ↓
显示"正在分析您的面相..."
    ↓
显示算命结果（微软黑话+祝福）
    ↓
显示春节祝福
    ↓
返回待机模式
```

### 非功能需求

#### 性能需求
- 人脸检测延迟 < 200ms
- 算命结果生成 < 1s
- 页面切换流畅，无卡顿

#### 兼容性需求
- 支持现代浏览器（Chrome/Edge最新版）
- 支持大屏幕显示（1920x1080及以上）
- 支持摄像头调用

#### 用户体验需求
- 操作简单，无需学习成本
- 流程完整，每步有明确提示
- 音效丰富，增强沉浸感

---

## 技术设计方案（RFC）

### 技术选型分析

#### 1. 人脸检测方案对比

**方案A：MediaPipe Face Detection（推荐）**
- **优势：**
  - Google官方支持，持续更新维护
  - WebAssembly运行，性能优秀（延迟 < 200ms）
  - GPU加速（WebGL），适合实时检测
  - 轻量级模型（~3MB），加载快速
  - 支持多脸检测
  - 完全浏览器端运行，隐私保护好
- **劣势：**
  - API相对较新，文档可能不够完善
  - 需要学习MediaPipe Tasks API
- **适用场景：** 实时人脸检测，性能要求高

**方案B：face-api.js**
- **优势：**
  - 基于TensorFlow.js，生态成熟
  - 支持68点landmark检测（比MediaPipe更详细）
  - 支持表情识别（可选功能）
  - 文档完善，社区活跃
- **劣势：**
  - 性能略低于MediaPipe（延迟可能 > 300ms）
  - Bundle size较大（~2-3MB）
  - 需要更多配置和优化
- **适用场景：** 需要详细landmark或表情识别

**方案C：TensorFlow.js + 自定义模型**
- **优势：**
  - 完全灵活，可自定义模型
  - 支持模型优化和量化
- **劣势：**
  - 开发成本高，需要训练/选择模型
  - 配置复杂，不适合快速开发
- **适用场景：** 需要完全自定义的场景

**推荐选择：MediaPipe Face Detection**
- 理由：性能优秀，官方支持，适合快速开发，完全满足需求

#### 2. 前端框架对比

**方案A：Vue.js 3（推荐）**
- **优势：**
  - Bundle size小（35-50KB），加载快速
  - 开发体验优秀，语法简洁
  - 响应式系统内置，性能好
  - 学习曲线平缓，快速上手
  - 单文件组件（SFC）结构清晰
  - 适合中小型项目快速开发
- **劣势：**
  - 生态相对React较小
  - 大型项目可能需要更多配置
- **性能指标：**
  - 初始加载时间：~1.2s
  - Bundle size：35-50KB
  - Time to Interactive：~1.2s

**方案B：React 18**
- **优势：**
  - 生态成熟，组件库丰富
  - 社区活跃，问题解决方案多
  - 适合大型项目，可扩展性强
  - 招聘市场React开发者更多
- **劣势：**
  - Bundle size较大（45-70KB）
  - 需要手动优化（useMemo, useCallback等）
  - 学习曲线较陡，需要理解Hooks
  - 开发速度相对较慢
- **性能指标：**
  - 初始加载时间：~1.4s
  - Bundle size：45-70KB
  - Time to Interactive：~1.4s

**推荐选择：Vue.js 3**
- 理由：快速开发，性能优秀，bundle size小，适合庙会现场快速部署

#### 3. 部署方案对比

**方案A：Vercel（推荐）**
- **优势：**
  - 部署速度快，自动化程度高
  - 全球CDN，性能优秀
  - 支持预览部署（PR预览）
  - 免费tier：100GB带宽/月，无需信用卡
  - 与GitHub集成无缝
  - 支持环境变量，配置简单
- **劣势：**
  - 免费tier有使用限制
  - 主要优化Next.js，其他框架支持略弱
- **适用场景：** 快速部署，需要预览功能

**方案B：Netlify**
- **优势：**
  - 功能全面，生态成熟
  - 免费tier：100GB带宽/月，300分钟构建时间
  - 支持Forms、Functions等内置功能
  - 支持Monorepo，多站点管理
  - 本地开发环境模拟好
- **劣势：**
  - 配置相对复杂
  - 免费tier限制较多
- **适用场景：** 需要完整平台功能

**方案C：GitHub Pages**
- **优势：**
  - 完全免费，无使用限制
  - 与GitHub集成，自动部署
  - 适合静态站点
- **劣势：**
  - 只支持静态站点，无Serverless Functions
  - 构建时间限制（10次/小时）
  - 功能相对简单
- **适用场景：** 纯静态站点，预算有限

**推荐选择：Vercel**
- 理由：部署快速，性能优秀，免费tier足够，适合快速上线

#### 4. 技术选型总结

| 技术栈 | 推荐方案 | 备选方案 | 理由 |
|--------|---------|---------|------|
| 人脸检测 | MediaPipe Face Detection | face-api.js | 性能优秀，官方支持 |
| 前端框架 | Vue.js 3 | React 18 | 快速开发，bundle size小 |
| 部署平台 | Vercel | Netlify | 部署快速，性能优秀 |
| 构建工具 | Vite | Create React App | 快速构建，HMR优秀 |
| 样式方案 | Tailwind CSS | CSS Modules | 快速开发，响应式友好 |
| 动画库 | GSAP | CSS Animations | 性能优秀，功能强大 |

#### 5. 技术选型决策树

**决策原则：快速开发 + 性能优先 + 零成本部署**

```
项目需求分析
    ↓
需要实时人脸检测？
    ├─ 是 → MediaPipe Face Detection（性能优先）
    └─ 否 → face-api.js（功能丰富）
    ↓
需要快速开发？
    ├─ 是 → Vue.js 3（开发速度快）
    └─ 否 → React 18（生态成熟）
    ↓
需要零成本部署？
    ├─ 是 → Vercel免费tier（100GB/月）
    └─ 否 → Netlify（功能更全面）
    ↓
需要快速构建？
    ├─ 是 → Vite（HMR快速）
    └─ 否 → Webpack（配置灵活）
```

#### 6. 技术选型理由总结

**为什么选择MediaPipe Face Detection？**
1. **性能优秀**：WebAssembly + GPU加速，延迟 < 200ms，满足实时检测需求
2. **官方支持**：Google官方维护，持续更新，稳定性好
3. **隐私保护**：完全浏览器端运行，数据不上传，符合隐私要求
4. **轻量级**：模型大小 ~3MB，加载快速
5. **多脸支持**：支持同时检测多个人脸，适合庙会场景

**为什么选择Vue.js 3？**
1. **快速开发**：语法简洁，学习曲线平缓，适合快速上线
2. **性能优秀**：Bundle size小（35-50KB），初始加载快
3. **开发体验**：Composition API灵活，单文件组件清晰
4. **响应式系统**：内置响应式，无需手动优化
5. **适合场景**：中小型项目，快速迭代

**为什么选择Vercel？**
1. **部署快速**：Git push自动部署，无需配置
2. **性能优秀**：全球CDN，访问速度快
3. **免费tier**：100GB带宽/月，足够使用
4. **预览功能**：PR预览，方便测试
5. **零配置**：开箱即用，无需复杂配置

**备选方案说明：**
- **face-api.js**：如果MediaPipe遇到兼容性问题，可快速切换到face-api.js
- **React 18**：如果团队更熟悉React，也可以使用，但开发速度会稍慢
- **Netlify**：如果需要更多功能（Forms、Functions），可以选择Netlify

### 技术栈

#### 前端框架（推荐：Vue.js 3）
```
- Vue.js 3（Composition API）
- Vite（构建工具，快速开发）
- Tailwind CSS（样式框架，快速开发）
- Web Speech API（可选，语音提示）
- Web Camera API（摄像头调用）
```

#### AI模型（推荐：MediaPipe Face Detection）
```
- MediaPipe Face Detection（人脸检测）
  - WebAssembly运行（浏览器端）
  - GPU加速（WebGL）
  - 实时检测（延迟 < 200ms）
  - 多脸支持（最多2人）
- 无需后端，完全前端运行
- 隐私保护：数据不存储，不上传
```

#### 部署方式（推荐：Vercel）
```
- Vercel（静态网站部署）
  - 自动部署（Git push触发）
  - 全球CDN加速
  - 预览部署（PR预览）
  - 免费tier：100GB带宽/月
- 备选：Netlify（功能更全面）
- 备选：GitHub Pages（完全免费，但功能有限）
```

### 系统架构

```
┌─────────────────────────────────────────────────┐
│        用户界面（Vue.js 3 + Tailwind CSS）     │
│    - 待机模式界面                               │
│    - 隐私授权弹窗                               │
│    - 算命结果展示                               │
├─────────────────────────────────────────────────┤
│         MediaPipe Face Detection               │
│    (WebAssembly + GPU Acceleration)            │
│    - 实时人脸检测（< 200ms延迟）                │
│    - 多脸支持（最多2人）                        │
├─────────────────────────────────────────────────┤
│         Web Camera API                        │
│    - 摄像头调用                                 │
│    - 视频流处理                                 │
├─────────────────────────────────────────────────┤
│         算命文案生成逻辑                      │
│    (预设模板 + 随机组合)                      │
│    - 职级/职位/运势文案库                      │
│    - 随机组合算法                               │
├─────────────────────────────────────────────────┤
│         动画与音效模块                        │
│    - GSAP动画库                                │
│    - Web Audio API                             │
└─────────────────────────────────────────────────┘
```

### 核心模块

#### 1. 人脸检测模块
```
功能：实时检测摄像头画面中的人脸
实现：
  - MediaPipe Face Detection API
  - GPU加速（WebGL）
  - 阈值设置（0.5 confidence）
  - 多脸支持（最多2人）
输入：摄像头视频流
输出：人脸坐标、置信度、6个关键点
```

#### 2. 隐私授权模块
```
功能：弹窗询问用户是否同意使用人脸信息
实现：
  - 状态管理（待机/授权/算命）
  - 用户选择记录（不存储人脸数据）
  - 不同意后返回待机模式
```

#### 3. 算命生成模块
```
功能：基于人脸分析生成算命文案
实现：
  - 预设文案库（职级、职位、运势）
  - 随机组合算法
  - 微软黑话词库
  - 祝福语词库
输出：算命结果文本
```

#### 4. 视觉展示模块
```
功能：展示算命结果
实现：
  - 动画效果（渐入、烟花、祥云）
  - 大屏幕适配
  - 音效播放
  - 倒计时自动返回待机
```

### 数据流程

```
摄像头视频流
    ↓
MediaPipe Face Detection
    ↓
检测到人脸？
    ↓ 否
待机模式
    ↓ 是
弹出隐私授权
    ↓
用户同意？
    ↓ 否
返回待机模式
    ↓ 是
模拟人脸分析（进度条）
    ↓
随机生成算命文案
    ↓
显示算命结果
    ↓
显示祝福语
    ↓
5秒后返回待机模式
```

### 隐私保护

#### 数据处理原则
```
- 人脸数据仅用于实时检测，不存储
- 不上传人脸图像到服务器
- 不进行人脸识别或身份验证
- 完全在浏览器端处理（WebAssembly）
```

#### 隐私授权
```
- 显式弹窗询问
- 用户可选择不同意
- 不同意后无法进行算命
- 明确告知数据用途
```

### 技术实现细节

#### 项目初始化（Vite + Vue.js 3）
```bash
# 创建项目
npm create vite@latest msft-fortune-teller -- --template vue
cd msft-fortune-teller

# 安装依赖
npm install
npm install @mediapipe/tasks-vision
npm install -D tailwindcss postcss autoprefixer
npm install gsap

# 初始化Tailwind CSS
npx tailwindcss init -p
```

#### MediaPipe Face Detection集成（Vue.js）
```vue
<script setup>
import { ref, onMounted, onUnmounted } from 'vue'
import { FilesetResolver, FaceDetection } from '@mediapipe/tasks-vision'

const videoRef = ref(null)
const faceDetector = ref(null)
const detections = ref([])

onMounted(async () => {
  // 初始化Face Detection
  const filesetResolver = await FilesetResolver.forVisionTasks(
    "https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision"
  )
  
  faceDetector.value = await FaceDetection.createFromOptions(
    filesetResolver,
    {
      baseOptions: {
        modelAssetPath: "https://storage.googleapis.com/mediapipe-models/face_detector/blaze_face_short_range/float16/1/blaze_face_short_range.tflite",
        delegate: "GPU"
      },
      minDetectionConfidence: 0.5,
      runningMode: "VIDEO"
    }
  )
  
  // 启动摄像头
  startCamera()
})

// 启动摄像头
async function startCamera() {
  const stream = await navigator.mediaDevices.getUserMedia({ video: true })
  videoRef.value.srcObject = stream
  videoRef.value.play()
  
  // 开始检测循环
  detectLoop()
}

// 检测循环
function detectLoop() {
  if (!faceDetector.value || !videoRef.value) return
  
  const result = faceDetector.value.detectForVideo(
    videoRef.value,
    performance.now()
  )
  
  detections.value = result.detections
  
  // 继续下一帧检测
  requestAnimationFrame(detectLoop)
}

onUnmounted(() => {
  // 清理资源
  if (videoRef.value?.srcObject) {
    videoRef.value.srcObject.getTracks().forEach(track => track.stop())
  }
})
</script>

<template>
  <video ref="videoRef" autoplay playsinline></video>
</template>
```

#### 算命文案生成（Vue.js Composition API）
```javascript
// composables/useFortune.js
import { ref } from 'vue'

const careerLevels = [
  "骨相清奇，必是L63以上的Senior！",
  "眉宇间透着Principal的气质，L65起步！",
  "眼神坚毅，一看就是资深SDE！",
  "面容沉稳，PM本色，产品思维拉满！",
  "这气质，Partner级别的人物啊！"
]

const blessings = [
  "龙年大吉，Bug全消，代码质量UP！",
  "新年好运，项目上线，性能完美！",
  "新春大吉，技术突破，薪资暴涨！",
  "春节快乐，Review秒过，合并顺利！"
]

export function useFortune() {
  const fortune = ref('')
  
  function generateFortune() {
    const career = careerLevels[Math.floor(Math.random() * careerLevels.length)]
    const blessing = blessings[Math.floor(Math.random() * blessings.length)]
    fortune.value = `${career}\n\n${blessing}`
    return fortune.value
  }
  
  return {
    fortune,
    generateFortune
  }
}
```

#### 动画效果（GSAP）
```javascript
// utils/animations.js
import { gsap } from 'gsap'

export function animateResultShow(element) {
  gsap.fromTo(element, 
    { opacity: 0, y: 50 },
    { opacity: 1, y: 0, duration: 0.5, ease: 'power2.out' }
  )
}

export function animateResultHide(element, callback) {
  gsap.to(element, {
    opacity: 0,
    y: -50,
    duration: 0.3,
    ease: 'power2.in',
    onComplete: callback
  })
}
```

#### Vercel部署配置
```json
// vercel.json
{
  "buildCommand": "npm run build",
  "outputDirectory": "dist",
  "devCommand": "npm run dev",
  "installCommand": "npm install",
  "framework": "vite",
  "rewrites": [
    { "source": "/(.*)", "destination": "/index.html" }
  ]
}
```

### 开发计划

#### 第一阶段：项目搭建（1小时）
- [ ] 使用Vite创建Vue.js 3项目（10分钟）
- [ ] 配置Tailwind CSS（10分钟）
- [ ] 配置项目结构（组件、工具函数）（20分钟）
- [ ] 配置Vercel部署（20分钟）

#### 第二阶段：核心功能（3小时）
- [ ] 集成MediaPipe Face Detection（1小时）
  - 安装依赖
  - 初始化Face Detection
  - 实现实时检测循环
- [ ] 实现待机模式（人脸检测）（30分钟）
  - 摄像头调用
  - 实时人脸检测
  - 检测框显示
- [ ] 实现隐私授权弹窗（30分钟）
  - 弹窗组件
  - 状态管理
  - 用户选择处理
- [ ] 实现算命文案生成（30分钟）
  - 文案库设计
  - 随机组合算法
  - 文案模板系统
- [ ] 实现结果展示页面（30分钟）
  - 结果页面组件
  - 动画效果
  - 自动返回待机

#### 第三阶段：优化完善（2小时）
- [ ] 添加音效（30分钟）
  - Web Audio API集成
  - 音效文件准备
  - 音效播放逻辑
- [ ] 添加动画效果（30分钟）
  - GSAP集成
  - 页面切换动画
  - 结果展示动画
- [ ] 优化大屏幕显示（30分钟）
  - 响应式布局
  - 字体大小适配
  - 视觉元素优化
- [ ] 测试调试（30分钟）
  - 浏览器兼容性测试
  - 性能优化
  - Bug修复

#### 第四阶段：部署上线（1小时）
- [ ] 部署到Vercel（20分钟）
  - 配置构建命令
  - 配置环境变量
  - 测试部署流程
- [ ] 现场测试（40分钟）
  - 摄像头测试
  - 性能测试
  - 用户体验测试

### 风险评估

#### 技术风险
```
风险1：浏览器兼容性问题
  - 风险描述：MediaPipe Face Detection需要WebAssembly和WebGL支持
  - 影响：部分旧浏览器可能无法运行
  - 缓解措施：
    * 测试Chrome/Edge最新版（主要使用场景）
    * 检测浏览器支持情况，显示友好提示
    * 准备降级方案（使用face-api.js作为备选）
  - 备用方案：准备备用浏览器（Chrome/Edge最新版）

风险2：摄像头调用失败
  - 风险描述：浏览器权限被拒绝或摄像头硬件故障
  - 影响：无法进行人脸检测
  - 缓解措施：
    * 现场提前测试摄像头
    * 友好的错误提示
    * 准备手动触发模式（点击按钮开始）
  - 备用方案：准备外接USB摄像头

风险3：人脸检测性能不足
  - 风险描述：低端设备可能无法流畅运行
  - 影响：检测延迟高，用户体验差
  - 缓解措施：
    * 使用GPU加速（WebGL）
    * 降低检测频率（30fps -> 15fps）
    * 优化模型加载（延迟加载）
  - 备用方案：
    * 降低检测精度（minDetectionConfidence: 0.5 -> 0.3）
    * 使用更轻量的模型

风险4：MediaPipe API变更
  - 风险描述：MediaPipe API可能更新，导致代码不兼容
  - 影响：需要更新代码
  - 缓解措施：
    * 锁定依赖版本
    * 查看MediaPipe官方文档
    * 准备face-api.js作为备选方案
  - 备用方案：切换到face-api.js（基于TensorFlow.js，更稳定）

风险5：Vercel部署问题
  - 风险描述：构建失败或部署延迟
  - 影响：无法及时上线
  - 缓解措施：
    * 提前测试部署流程
    * 准备Netlify作为备选
    * 本地构建测试
  - 备用方案：切换到Netlify或GitHub Pages
```

#### 用户体验风险
```
风险1：用户不愿意授权
  - 缓解措施：明确说明用途
  - 应对方案：尊重用户选择

风险2：算命结果不够搞笑
  - 缓解措施：丰富文案库
  - 应对方案：主持人补充幽默
```

---

## 品牌植入

### AI Course Developer植入方式

#### 1. 算命文案植入
```
"龙年大吉，AI Course Developer祝您技术突破！"
"新春快乐，来AI Course Developer学AI，天下我有！"
```

#### 2. 课程优惠植入
```
算命结束后显示：
"AI算命师建议：新学AI，扫码领AI课程优惠券"
```

#### 3. 技术展示
```
"基于MediaPipe + WebAssembly的实时人脸检测"
"完全在浏览器端运行，保护您的隐私"
```

---

## 实施建议

### 推荐方案：**AI算命师**

**理由：**
1. **互动性强**：用户主动参与，不是被动观看
2. **多模态展示**：摄像头+视觉AI，技术展示度高
3. **趣味性强**：微软黑话+算命，娱乐效果好
4. **节日氛围浓**：春节祝福+算命文化
5. **适合程序员**：无需尝试，直接看效果
6. **品牌植入自然**：算命文案+祝福语自然植入

### 备选方案
无，此方案为唯一推荐方案。

---

## 总结

**推荐方案：AI算命师**

**核心优势：**
1. 摄像头人脸检测，多模态交互
2. 微软黑话趣味算命，娱乐性强
3. 春节祝福+算命文化，节日气氛浓
4. 浏览器端运行，保护隐私
5. 快速体验，适合流动人群
6. 技术展示度高，符合品牌定位

**预期效果：**
- 热闹喜庆，符合庙会氛围
- 观众积极参与，不冷场
- 自然展示AI多模态能力
- 有效植入AI Course Developer品牌
- 后续可传播（算命录像、截图分享）

---

*创建时间：2026年2月6日*
*最后更新：2026年2月6日*
